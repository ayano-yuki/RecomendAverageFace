# レコメンドアルゴリズム詳細

## 1. 本システムの特徴
- ユーザーの推しキャラの平均顔画像の特徴量とアニメキャラの平均顔特徴量の類似度（推し度）を活用
- レビュー評価・レビュー件数・ジャンル好みも加味
- 合成スコアでランキングするハイブリッド型

## 2. 従来のレコメンド手法との違い
- 協調フィルタリング：視聴履歴の類似性を使う
- コンテンツベース：ジャンルやタグ、説明文などを使う
- 本システム：推しキャラの平均顔特徴量を主軸に、従来手法の要素も加味
- 推し顔特徴量を使うことで“推しキャラ”発見の体験を強化

## 3. アルゴリズムの流れ
1. similarity_results.csvから、ユーザーの推しキャラの平均顔特徴量と類似度が高いキャラ（閾値以上）を抽出
2. そのキャラが登場する未視聴アニメを抽出
3. アニメごとに推し度（合計・最大・平均）、推しキャラ数を集計
4. ジャンル・レビュー点・レビュー件数を付与
5. 推し度・レビュー点を正規化、レビュー件数はlog重み、推しキャラ数も加点
6. ユーザーがよく見るジャンルのアニメはさらに加点
7. 合成スコアでランキング

## 4. 合成スコアの式
```
合成スコア = 推し度正規化×α + レビュー点正規化×β + 推しキャラ数×γ + レビュー件数重み×δ + ジャンル好みスコア×ε
```
- α, β, γ, δ, εはmain.pyで調整可能

## 5. 類似度計算について
- 推しキャラの平均顔画像→特徴抽出（外部処理）→キャラ平均顔特徴量とコサイン類似度等でスコア化
- similarity_results.csvに保存

## 6. レビュー・ジャンル情報の活用
- レビュー点は信頼性向上のため件数で重み付け
- ジャンル好みは視聴履歴から自動集計

## 7. 出力例
- 合成スコア順に、推しキャラ名・ジャンル・レビュー点・理由を詳細表示

## 8. 応用・拡張例
- 類似度のしきい値自動調整
- ユーザーの明示的なジャンル好み反映
- 他の特徴量（年齢・性別・SNS情報等）との組み合わせ 